name: SubWorkflow CDK Deploy
env:
  AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
  AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
  AWS_DEFAULT_REGION: 'eu-central-1'
  CDK_TOOLING_ENV_FOLDER: infra_tooling_account
  CDK_MONITORED_ENV_FOLDER: infra_monitored_account
  STAGE_NAME: devcdk
on: [workflow_call]
jobs:
  CDKDeployJob:
    runs-on: ubuntu-latest
    steps:
      - name: CDK deploy Tooling Env
        run: |
          cd ${{ env.CDK_TOOLING_ENV_FOLDER }}
          cdk deploy --context stage-name=${{ env.STAGE_NAME }}  --require-approval never
        